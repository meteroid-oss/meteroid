syntax = "proto3";

package meteroid.portal.checkout.v1;

import "portal/checkout/v1/models.proto";
import "api/customers/v1/models.proto";
import "api/invoices/v1/models.proto";

message GetSubscriptionCheckoutRequest {
  optional string subscription_id = 1;
}

message GetSubscriptionCheckoutResponse {
  Checkout checkout = 1;
}


message ConfirmCheckoutRequest {
  string payment_method_id = 1;
  uint64 displayed_amount = 2;
  string displayed_currency = 3;
  optional string subscription_id = 4;
}
message ConfirmCheckoutResponse {
  api.invoices.v1.Transaction transaction = 1;
}

message GetSlotUpgradeCheckoutRequest {
  string subscription_id = 1;
  string price_component_id = 2;
  int32 delta = 3;
}
message GetSlotUpgradeCheckoutResponse {
  SlotUpgradeCheckout checkout = 1;
}

message ConfirmSlotUpgradeCheckoutRequest {
  string subscription_id = 1;
  string price_component_id = 2;
  int32 delta = 3;
  string payment_method_id = 4;
  uint64 displayed_amount = 5;
  string displayed_currency = 6;
}
message ConfirmSlotUpgradeCheckoutResponse {
  api.invoices.v1.Transaction transaction = 1;
  uint32 new_slot_count = 2;
}

service PortalCheckoutService {
 rpc GetSubscriptionCheckout(GetSubscriptionCheckoutRequest) returns (GetSubscriptionCheckoutResponse) {}
  rpc ConfirmCheckout(ConfirmCheckoutRequest) returns (ConfirmCheckoutResponse) {}
  rpc GetSlotUpgradeCheckout(GetSlotUpgradeCheckoutRequest) returns (GetSlotUpgradeCheckoutResponse) {}
  rpc ConfirmSlotUpgradeCheckout(ConfirmSlotUpgradeCheckoutRequest) returns (ConfirmSlotUpgradeCheckoutResponse) {}
}
